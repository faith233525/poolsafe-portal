#!/usr/bin/env bash
. "$(dirname -- "$0")/_/husky.sh"

MSG_FILE=$1

# Allow skip like [skip hooks]
if grep -qi '\[skip hooks\]' "$MSG_FILE"; then
  echo "⏭  commit-msg hook skipped via [skip hooks] token"
  exit 0
fi

# Conventional commit lint
if npx --no-install commitlint --edit "$MSG_FILE"; then
  echo "✅ Commit message passes conventional commit rules"
else
  echo "❌ Commit message failed linting. See: https://www.conventionalcommits.org/" >&2
  exit 1
fi
